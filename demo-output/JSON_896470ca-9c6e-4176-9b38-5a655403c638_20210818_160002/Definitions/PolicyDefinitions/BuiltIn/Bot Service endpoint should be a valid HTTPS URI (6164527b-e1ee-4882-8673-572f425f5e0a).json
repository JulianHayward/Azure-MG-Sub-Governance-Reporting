{
  "displayName": "Bot Service endpoint should be a valid HTTPS URI",
  "policyType": "BuiltIn",
  "mode": "Indexed",
  "description": "Data can be tampered with during transmission. Protocols exist that provide encryption to address problems of misuse and tampering. To ensure your bots are communicating only over encrypted channels, set the endpoint to a valid HTTPS URI. This ensures the HTTPS protocol is used to encrypt your data in transit and is also often a requirement for compliance with regulatory or industry standards. Please visit: https://docs.microsoft.com/azure/bot-service/bot-builder-security-guidelines.",
  "metadata": {
    "version": "1.0.1",
    "category": "Bot Service"
  },
  "parameters": {
    "effect": {
      "type": "String",
      "metadata": {
        "displayName": "Effect",
        "description": "The desired effect of the policy."
      },
      "allowedValues": [
        "audit",
        "deny",
        "disabled"
      ],
      "defaultValue": "audit"
    }
  },
  "policyRule": {
    "if": {
      "allOf": [
        {
          "field": "type",
          "equals": "Microsoft.BotService/botServices"
        },
        {
          "field": "Microsoft.BotService/botServices/endpoint",
          "notLike": "https://*"
        }
      ]
    },
    "then": {
      "effect": "[parameters('effect')]"
    }
  }
}

